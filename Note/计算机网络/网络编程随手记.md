# 网络编程随手记

## 1. C/S 服务器模型

服务器启动时，首先创建一个监听用的 socket，并绑定到感兴趣的端口上，然后调用 listen 等待客户端的连接。

而客户端要做的就是创建一个连接用的 socket，使用 connect 连接到指定的 ip 和端口，然后此时服务器会调用 accept 接受连接，此时的连接就算建立成功了。

对于简单的一次连接建立这样就行了，然而，现实中我们的服务器可能会在同一时间面对大量的连接，此时就需要我们的 I/O 模型来监听这一事件，常见的 I/O 模型有我们熟悉的 select，我们通过 select 系统调用同时监听多个客户端请求，一旦有新的请求到达，就会通过 fork 创建新的进程去处理刚刚到达的请求。值得注意的是，我们常说的 TCP 三次握手就是在 connect 的时候实现的。

当访问量过大的时候，服务器的响应可能会变慢。

## 2. P2P 模型

抛弃了以服务器为中心的格局，感觉跟分布式系统挺像的。

实际的P2P模型还有一个注册发现服务器，供查找服务，不过现在感觉还是 C/S 架构更多。

另外，P2P 也可以看作是 C/S 模型的扩展吧。

## 3. Reactor 和 Proactor 模式

Reactor 要求主线程只负责监听文件描述符上是否有事件发生，有的话就会将该事件通知工作线程，读写数据，接受新的连接均在工作线程中进行。

而 Proactor 模式将所有的 I/O 操作交给主线程和内核来处理，工作线程仅负责业务逻辑，什么意思？意思是工作线程只需要接受已经处理好的数据，然后负责逻辑处理就行了，而不需要 I/O 操作。

## 4. I/O 多路复用

